language: python

python:
  - 2.7
  
install:
  - pip install -r requirements.txt

# Postgres binds to 127.0.0.1 by default and is started on boot. Default username is "postgres" with no password
# Create a DB as part of before script to use it


before_script:
  - psql -c 'create database test;' -U postgres
  - mkdir -p shippable/testresults
  - mkdir -p shippable/codecoverage

script:
  - nosetests test.py --with-xunit --xunit-file=shippable/testresults/nosetests.xml
  - which python && coverage run --branch test.py
  - which python && coverage xml -o shippable/codecoverage/coverage.xml test.py
  - echo $name and $version 

addons:
    postgresql : 9.1
env:
 global:
   - secure: kz3TITFqlu09gmR0R5qP+JcDC/XOpWbWx4GYy1cZLFlecBE4XATcHbsir3pnf6U/GlbZK5IKOj31ESbnnCrfaAK5E0BadseE69WeEgzNRHN2nKshIRyobpB2m3YmNWcFlqN7Ev2xyq67L4LrWFEFcC20zMmmiuc0rnWi2ilKVQmoDUYiHffOm0+sLzoJT6mInUlkPb+ztcVGZt0ziyvx1NQexDywg+xV2PN6Mpl06xkg+mnPH/QYFo3lIL4JnphuPeb6mQ5CGKZzTutW4Zty86cOBjQVRPIk9OMrQjSIhpx+HqjBHdlOQJjqz+94GJw0YuhYKMVALC+2IvXWVuagCw==
   
  matrix:
   - secure: b4XOYOn/KYL2n/1PLR5jZiXxZxfH7caIUYbsqPoPMmn6qsYhKC2aVqgLGSUJC2K0qVU3R/eAI0+32QQIijDbAgIKY/9UCVcjUO0D5y3ONslkWCsLzhGrUUGDD0rSs2XNf8ET9wtjQ/hgXBwwKIO8GMco4zG4v2e3sGFb1agbGD5Lz7KAwikUf+WZoVIOrhvpsDQgnoVT55vCGpnmOiUyPGiWAQ8V9YFBmTk+ikyCYuOeeHppstEWdmn/fVYc1VXfdMxBHOqLPuqoS7Zw8eBTlP13tlh/kSY/57pMdH2rm2ZgAiyEppkqYj2xMpU8quDxMXd5s/x0tocmtgEosUNaJQ==
   
